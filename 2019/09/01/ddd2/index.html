<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="领域驱动设计领域的理解设计细节"><meta name="keywords" content><meta name="author" content="zhuyuping"><meta name="copyright" content="zhuyuping"><title>领域驱动设计领域的理解设计细节 | 朱遇平的github博客</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.0"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">zhuyuping</div><div class="author-info__description text-center">掌握java相关知识，擅长大数据，以及机器学习算法应用方面 java scala python</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">20</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">4</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">朱遇平的github博客</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">领域驱动设计领域的理解设计细节</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-09-01</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>前面一篇讲了领域驱动设计的基本理解。这一部分讲讲，领域驱动设计的细节。我们前面说了从全局上其实类似于国家组织结构，划分领域，其实对每个领域<br>或者说核心域来说还有一些支撑域与公用域，每一个限定上下文是一个域或者子域，而不同的上下文之间，也就是不同的领域之间通过领域事件来进行上下文集成，方式有聚合结合RPC相关使用，有领域事件的发布订阅或者MQ，或者防腐层引入进行聚合根的转换，或者event source模式直接记录领域事件流水，其他上下文订阅消费就行。领域事件可以简单也可以复杂，简单的只带一些id通过id可以反向查找，复杂的多带一些数据信息方便后面订阅上下文进行处理。</p>
<p>  我们知道上下文对于一个子域，而对于每一个子域来说他内部的聚合是被限定到上下文的，比如授信借款服务，审批单可能在授信域 以及 借款域 以及催收域存在，但是审批单在不同上下文意义不同，而且不同子域意义不一样，所以设计上避免被外部修改，一般屏蔽set方法而通过聚合根的方法进行修改。一般定义后外部集成时候尽量引入防腐层进行转换隔离。对于每一个子域来说，里面就是聚合，聚合是一个凡凡的概念，其实聚合有根 聚合根实体，有实体，有值对象，我们设计时候一般设计聚合根对象，实体，以及值对象，聚合根依赖复合实体以及值对象，对于实体来说实体一般是容易变化的需要持久化<br>而且有唯一标识的对象抽象，而值对象是那些不变的抽象属性信息，另外有时候我们尽量在聚合根中实现相关领域技术逻辑，不要通过转换器，包装器等工具类来进行转换逻辑，我的经验是还有尽可能在不同上下文之间的聚合之间在建立一个防腐层，就是定义一些中间对象用来进行转换隔离。对于每一个聚合来说尽可能职能单一，简单，如果在同一个事务里面，实体同时变化时候可以合并到一个聚合根里面，如果非实时就用领域事件来处理吧。</p>
<p>下面来用通俗的话来理解就是，我们国家比如有信息安全部，信息安全部下面有很多子部门，负责某一项单一的事务，监察，收集，分析，对于这些都有不同的聚合，这些聚合，有唯一的根以及要做的行为，也就是聚合根，而统一的信息以及用户标志，这些实体以及值对象，被聚合根依赖并执行相应的方法，进行监察，收集，分析，当监察到违规行为，这时候会需要进行通知公安部其他子域，首先信息安全部会进行自己的操作，并持久化记录下来，并产生一个领域事件（违规事件） 通过防腐层转换加密 通过 RPC 或者 发布，然后公安部防腐层转换解密 RPC接受或订阅，在公安部的子域的聚合根里面实现相应的逻辑，进行调用相应的实体以及值对象调用相应的方法进行抓人。<br>所以其实领域驱动最难的地方就是：<br>    每一个子域的划分<br>    子域里面聚合的定义<br>    应当记住 1：子域之间集成上下文映射只通过领域事件集合防腐层进行隔离解耦。<br>            2：业务领域的逻辑实现在领域聚合里面，不要实现到工具类或者应用层里面。<br>            3：实际中 我们要记住的是以不变应万变。在领域DDD里面，尽可能单一，聚合根行为尽可能保持在一个事务里面，聚合根方法，跟应用层防腐层尽可能解耦，领域事件类型尽可能单一。这样才能不变应万变。</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">zhuyuping</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yoursite.com/2019/09/01/ddd2/">http://yoursite.com/2019/09/01/ddd2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"></div><nav id="pagination"><div class="next-post pull-right"><a href="/2019/08/29/ddd/"><span>我对DDD领域驱动设计的理解</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2019 By zhuyuping</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.0"></script><script src="/js/fancybox.js?version=1.6.0"></script><script src="/js/sidebar.js?version=1.6.0"></script><script src="/js/copy.js?version=1.6.0"></script><script src="/js/fireworks.js?version=1.6.0"></script><script src="/js/transition.js?version=1.6.0"></script><script src="/js/scroll.js?version=1.6.0"></script><script src="/js/head.js?version=1.6.0"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script></body></html>